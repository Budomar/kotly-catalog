<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–¢–µ—Å—Ç –∫–Ω–æ–ø–∫–∏ –∫–æ—Ä–∑–∏–Ω—ã</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-container { max-width: 600px; margin: 0 auto; }
        .test-button { 
            padding: 15px 30px; 
            background: #007bff; 
            color: white; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer; 
            font-size: 16px;
            margin: 10px 0;
        }
        .test-result { 
            margin-top: 20px; 
            padding: 15px; 
            border-radius: 5px; 
            background: #f8f9fa;
        }
        .success { color: green; border: 2px solid green; }
        .error { color: red; border: 2px solid red; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üîß –¢–µ—Å—Ç —Ä–∞–±–æ—Ç—ã –∫–Ω–æ–ø–∫–∏ –∫–æ—Ä–∑–∏–Ω—ã</h1>
        
        <button class="test-button" onclick="testAddToCart()">
            üß™ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É
        </button>
        
        <button class="test-button" onclick="testCartFunctions()">
            üìã –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∫–æ—Ä–∑–∏–Ω—ã
        </button>
        
        <div id="test-result" class="test-result"></div>
    </div>

    <script>
        // –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        const testProducts = [{
            –ê—Ä—Ç–∏–∫—É–ª: 'TEST001',
            –ú–æ–¥–µ–ª—å: '–¢–µ—Å—Ç–æ–≤—ã–π –∫–æ—Ç–µ–ª 24 –∫–í—Ç',
            –¶–µ–Ω–∞: 25000,
            –í_–Ω–∞–ª–∏—á–∏–∏: 5,
            –ú–æ—â–Ω–æ—Å—Ç—å: '24',
            –ö–æ–Ω—Ç—É—Ä—ã: '–î–≤—É—Ö–∫–æ–Ω—Ç—É—Ä–Ω—ã–π',
            WiFi: '–î–∞',
            –§–æ—Ç–æ: 'images/default.jpg'
        }, {
            –ê—Ä—Ç–∏–∫—É–ª: 'TEST002', 
            –ú–æ–¥–µ–ª—å: '–¢–µ—Å—Ç–æ–≤—ã–π –∫–æ—Ç–µ–ª 32 –∫–í—Ç',
            –¶–µ–Ω–∞: 32000,
            –í_–Ω–∞–ª–∏—á–∏–∏: 3,
            –ú–æ—â–Ω–æ—Å—Ç—å: '32',
            –ö–æ–Ω—Ç—É—Ä—ã: '–û–¥–Ω–æ–∫–æ–Ω—Ç—É—Ä–Ω—ã–π',
            WiFi: '–ù–µ—Ç',
            –§–æ—Ç–æ: 'images/default.jpg'
        }];

        function testAddToCart() {
            const resultDiv = document.getElementById('test-result');
            resultDiv.innerHTML = '<h3>üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ä–∑–∏–Ω—É...</h3>';
            
            try {
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
                window.allProducts = testProducts;
                window.cart = [];
                window.currentDiscount = 0;

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Ñ—É–Ω–∫—Ü–∏—è addToCart
                if (typeof addToCart !== 'function') {
                    resultDiv.innerHTML += '<p class="error">‚ùå –§—É–Ω–∫—Ü–∏—è addToCart –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!</p>';
                    return;
                }

                resultDiv.innerHTML += '<p>‚úÖ –§—É–Ω–∫—Ü–∏—è addToCart –Ω–∞–π–¥–µ–Ω–∞</p>';

                // –ü—Ä–æ–±—É–µ–º –¥–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä
                const result = addToCart('TEST001');
                
                if (result && window.cart.length > 0) {
                    resultDiv.innerHTML += `
                        <p class="success">‚úÖ –¢–æ–≤–∞—Ä —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É!</p>
                        <p>üì¶ –¢–æ–≤–∞—Ä–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω–µ: ${window.cart.length}</p>
                        <p>üè∑Ô∏è –ù–∞–∑–≤–∞–Ω–∏–µ: ${window.cart[0].–ú–æ–¥–µ–ª—å}</p>
                        <p>üî¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: ${window.cart[0].quantity}</p>
                        <p>üí∞ –¶–µ–Ω–∞: ${window.cart[0].–¶–µ–Ω–∞} —Ä—É–±.</p>
                    `;
                } else {
                    resultDiv.innerHTML += '<p class="error">‚ùå –¢–æ–≤–∞—Ä –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É</p>';
                }

            } catch (error) {
                resultDiv.innerHTML += `<p class="error">‚ùå –û—à–∏–±–∫–∞: ${error.message}</p>`;
                console.error('–û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∞:', error);
            }
        }

        function testCartFunctions() {
            const resultDiv = document.getElementById('test-result');
            resultDiv.innerHTML = '<h3>üìã –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π –∫–æ—Ä–∑–∏–Ω—ã...</h3>';
            
            try {
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º
                window.allProducts = testProducts;
                window.cart = [];
                window.currentDiscount = 10; // 10% —Å–∫–∏–¥–∫–∞

                // –¢–µ—Å—Ç–∏—Ä—É–µ–º –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏
                const functionsToTest = ['addToCart', 'updateCartItem', 'removeFromCart', 'updateCartBadge'];
                let passed = 0;
                let failed = 0;

                functionsToTest.forEach(funcName => {
                    if (typeof window[funcName] === 'function') {
                        resultDiv.innerHTML += `<p>‚úÖ ${funcName} - –Ω–∞–π–¥–µ–Ω–∞</p>`;
                        passed++;
                    } else {
                        resultDiv.innerHTML += `<p class="error">‚ùå ${funcName} - –Ω–µ –Ω–∞–π–¥–µ–Ω–∞</p>`;
                        failed++;
                    }
                });

                // –¢–µ—Å—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
                if (typeof addToCart === 'function') {
                    addToCart('TEST001');
                    addToCart('TEST002');
                    resultDiv.innerHTML += `<p>üì¶ –î–æ–±–∞–≤–ª–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤: ${window.cart.length}</p>`;
                }

                resultDiv.innerHTML += `
                    <hr>
                    <p><strong>–ò—Ç–æ–≥:</strong></p>
                    <p>‚úÖ –ü—Ä–æ–π–¥–µ–Ω–æ: ${passed}</p>
                    <p>‚ùå –ù–µ –ø—Ä–æ–π–¥–µ–Ω–æ: ${failed}</p>
                `;

            } catch (error) {
                resultDiv.innerHTML += `<p class="error">‚ùå –û—à–∏–±–∫–∞: ${error.message}</p>`;
            }
        }

        // –ü—Ä–æ—Å—Ç–∞—è –≤–µ—Ä—Å–∏—è —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è —Ç–µ—Å—Ç–∞
        if (typeof addToCart === 'undefined') {
            window.addToCart = function(article) {
                const product = window.allProducts.find(p => p.–ê—Ä—Ç–∏–∫—É–ª === article);
                if (!product) return false;

                const existingItem = window.cart.find(item => item.–ê—Ä—Ç–∏–∫—É–ª === article);
                
                if (existingItem) {
                    existingItem.quantity += 1;
                } else {
                    window.cart.push({
                        ...product,
                        quantity: 1,
                        discountPrice: product.–¶–µ–Ω–∞ * (1 - (window.currentDiscount || 0) / 100)
                    });
                }
                
                return true;
            };
        }
    </script>
</body>
</html>